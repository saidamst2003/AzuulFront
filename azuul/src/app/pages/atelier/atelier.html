<app-navbar></app-navbar>

<section class="hero-section">
    <div class="hero-content">
        <h1>Nos Ateliers Créatifs</h1>
        <p>Découvrez nos ateliers uniques où créativité et bien-être se rencontrent pour des moments inoubliables</p>
    </div>
</section>

<div *ngIf="isAdmin" class="admin-toolbar">
  <button class="admin-action-btn" (click)="openCreateForm()">
    <i class="fas fa-plus"></i> Créer un Atelier
  </button>
</div>

<main class="main-container">
    <div *ngIf="error" class="error-message global-error">{{ error }}</div>

    <div class="workshops-grid">
        <div *ngFor="let atelier of ateliers" class="workshop-card">
            <div class="workshop-image">
                <ng-container *ngIf="atelier.photo">
                    <img [src]="'http://localhost:8081' + atelier.photo" [alt]="atelier.nom" (error)="onImgError($event)">
                </ng-container>
               
                <div *ngIf="isAdmin" class="admin-card-actions">
                    <button class="icon-btn" (click)="openEditForm(atelier)"><i class="fas fa-edit"></i></button>
                    <button class="icon-btn" (click)="deleteAtelier(atelier.id!)"><i class="fas fa-trash"></i></button>
                </div>
            </div>
            <div class="workshop-content">
                <h3 class="workshop-title">{{ atelier.nom }}</h3>
                <p class="workshop-description">{{ atelier.description }}</p>
                <div class="workshop-footer">
                    <div class="workshop-info">
                        <span class="info-item"><i class="far fa-calendar-alt"></i> {{ atelier.date | date: 'dd/MM/yyyy' }}</span>
                        <span class="info-item"><i class="far fa-clock"></i> {{ atelier.heure }}</span>
                    </div>
                    <a href="#" class="workshop-btn">
                        Réserver <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</main>

<div *ngIf="showForm" class="modal-backdrop">
  <div class="modal-content">
    <form [formGroup]="atelierForm" (ngSubmit)="submitForm()" novalidate>
      <h3 class="modal-title">{{ editingAtelier ? 'Modifier' : 'Créer' }} un Atelier</h3>
      
      <div class="form-group">
        <label for="nom">Nom</label>
        <input id="nom" name="nom" type="text" formControlName="nom" required>
      </div>
      
      <div class="form-group">
        <label for="description">Description</label>
        <input id="description" name="description" type="text" formControlName="description" class="form-control" placeholder="Description">
      </div>
      <div class="form-group">
        <label for="genre">Genre</label>
        <input id="genre" name="genre" type="text" formControlName="genre" class="form-control" placeholder="Genre">
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="date">Date</label>
          <input id="date" name="date" type="date" formControlName="date" required>
        </div>
        <div class="form-group">
          <label for="heure">Heure</label>
          <input id="heure" name="heure" type="time" formControlName="heure" required>
        </div>
        <div class="form-group" *ngIf="!editingAtelier">
          <label for="photo">Photo:</label>
          <input id="photo" name="photo" type="file" (change)="onFileSelected($event)" class="form-control-file">
          <div *ngIf="imagePreview" class="image-preview-container">
            <img [src]="imagePreview" alt="Aperçu de l'image" class="image-preview" style="max-width: 200px; margin-top: 10px;" />
          </div>
        </div>
      </div>
      
      <div class="modal-actions">
        <button type="submit" class="btn-submit" [disabled]="!atelierForm.valid">
          {{ editingAtelier ? 'Enregistrer' : 'Créer' }}
        </button>
        <button type="button" class="btn-cancel" (click)="cancel()">Annuler</button>
      </div>
    </form>
  </div>
</div>

<app-footer></app-footer>
